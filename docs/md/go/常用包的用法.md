### 1.ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•°

![image-20220902095809338](../img/image-20220902095809338.png)

å…¶ä¸­næ˜¯å–ä¸åˆ°çš„

```go
package main

import (
	"fmt"
	"math/rand"
	"time"
)

func main() {
	//è·å–å½“å‰æ—¶é—´å¯¹è±¡
	//timeObj := time.Now()

	//è·å–å½“å‰æ—¶é—´çš„çº³ç§’æ•°
	//timestamp1 := timeObj.UnixNano()
  	//rand.Seed(timestamp1)

	// é‡ç½®éšæœºçš„ç§å­æ•°é‡ æ‰èƒ½è®©æ¯æ¬¡è¿è¡Œå‡ºä¸åŒçš„éšæœºæ•°é‡
  rand.Seed(time.Now().UnixNano())

	//éšæœºå‡º10 ~100åˆ°çš„æ•´æ•° 100 - 10 = 90+1 ã€‚éšæœºå‡º0ï½90çš„æ•´æ•°ï¼Œå†åŠ 10ï¼Œå°±æ˜¯10ï½100çš„éšæœºæ•°
	num := rand.Intn(90+1) + 10
	fmt.Print(num)
}

```



### 2.å®šæ—¶å™¨

```
package main

import (
	"fmt"
	"time"
)

func main() {
	ticker := time.NewTicker(3*time.Second)
	count := 0
	for v := range ticker.C {
		fmt.Println("h")
		fmt.Println(v)
		count++
		if count > 5 {
			ticker.Stop()
			break
		}
	}
}
```



### 3.æ•°æ®åº“æ“ä½œ



### 4.jsonæ“ä½œ

1ğŸ””å°†æ•°æ®ç¼–ç ä¸ºJSONæ ¼å¼



```
package main
 
import (
	"encoding/json"
	"fmt"
)
 
type Student struct {
	Name   string `json:"name"`
	Age    int    `json:"age"`
	Email  string `json:"email"`
	Wechat string `json:"wechat"`
}
 
func JsonMarshal() {
	xiaoMing := Student{
		Name:   "xiaoMing",
		Age:    23,
		Email:  "vip_13031075266@163.com",
		Wechat: "ssjjqq23",
	}
 
	fmt.Println(xiaoMing)
 
	data, _ := json.Marshal(xiaoMing)
	fmt.Printf("%s\n", data)
}
```

2ğŸ””å¯¹JSONæ•°æ®è¿›è¡Œè§£ç 



```
package main
 
import (
	"encoding/json"
	"fmt"
	"log"
)
 
type Student struct {
	Name   string `json:"name"`
	Age    int    `json:"age"`
	Email  string `json:"email"`
	Wechat string `json:"wechat"`
}
type Msg struct {
	MessageType string          `json:"message_type"`
	MessageBody json.RawMessage `json:"message_body"`
}
 
func JsonUnMarshal() {
	jsonData := []byte(`{"name":"xiaoMing","age":23,
	"email":"vip_13031075266@163.com","wechat":"ssjjqq23"}`)
 
	var xiaoMing Student
	err := json.Unmarshal(jsonData, &xiaoMing)
	if err != nil {
		log.Print(err)
	}
	fmt.Printf("%+v\n", xiaoMing)
}
```

3.ğŸ””è§£ç æœªçŸ¥ç»“æ„çš„JSONæ•°æ®

å€ŸjsonvalueåŒ…

```
package main

import (
	"fmt"
	jsonvalue "github.com/Andrew-M-C/go.jsonvalue"
)

func main() {

	str := `{
	"MESSAGE_type":"tcp_log",
		"message_body":{
		"time":1629,
			"sess_id":"0x611DD45400000001",
			"demo":{"name":"123","age":12},
	}
}`
	v,_ := JsonUnMarshalUnknownJson(str)
	//value,_ := v.Get("MESSAGE_type")//tcp_log
	//value,_ := v.Get("message_body")//{time: 1629, sess_id: 0x611DD45400000001, demo: {name: 123, age: 12}}
	//value,_ := v.Get("message_body","time")//1629
	//value,_ := v.Get("message_body","demo")//{name: 123, age: 12}
	//value,_ := v.Get("message_body","demo","name")//123
	value,_ := v.Get("message_body","demo","age")//12
	
	fmt.Println(value)
}

func JsonUnMarshalUnknownJson(jsonstr string) (*jsonvalue.V, error){
	//raw := []byte(jsonstr)
	v,err := jsonvalue.UnmarshalString(jsonstr)

	//https://github.com/Andrew-M-C/go.jsonvalue/blob/master/docs/zh-cn/03_get.md jsonvalueæ–‡æ¡£
	fmt.Printf("%T\n",v)//*jsonvalue.V
	fmt.Println(v)//{MESSAGE_type: tcp_log, message_body: {time: 1629, sess_id: 0x611DD45400000001, demo: {name: 123, age: 12}}}
	
	return v,err//å¯ä»¥è·å–å¾ˆå¤šç±»å‹çš„æ•°æ®.
}

```



### 5.mysqlæ“ä½œ

1.ä¸‹è½½å¯¹åº”çš„åŒ…

go get -u github.com/go-sql-driver/mysql

```
"database/sql"æ˜¯goè‡ªå¸¦çš„åŒ…
```

```
//æµ‹è¯•é“¾æ¥
import (
	"database/sql"

	_ "github.com/go-sql-driver/mysql"
)

func main() {
   // DSN:Data Source Name
	dsn := "user:password@tcp(127.0.0.1:3306)/dbname"
	db, err := sql.Open("mysql", dsn)
	if err != nil {
		panic(err)
	}
	defer db.Close()  // æ³¨æ„è¿™è¡Œä»£ç è¦å†™åœ¨ä¸Šé¢erråˆ¤æ–­çš„ä¸‹é¢ï¼Œå› ä¸ºå¦‚æœdbæœ‰é”™è¯¯çš„è¯ï¼Œè€Œä¸”æ²¡æœ‰ç»è¿‡erråˆ¤æ–­ï¼Œä¼šå‡ºç°åœ¨nilå˜é‡ä¸Šè°ƒç”¨closeæ–¹æ³•å°±panicäº†
}
```



```go
//æ¨¡å—åŒ–çš„æµ‹è¯•é“¾æ¥

// å®šä¹‰ä¸€ä¸ªå…¨å±€å¯¹è±¡db
//å…¶ä¸­sql.DBæ˜¯è¡¨ç¤ºè¿æ¥çš„æ•°æ®åº“å¯¹è±¡ï¼ˆç»“æ„ä½“å®ä¾‹ï¼‰ï¼Œå®ƒä¿å­˜äº†è¿æ¥æ•°æ®åº“ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯ã€‚å®ƒå†…éƒ¨ç»´æŠ¤ç€ä¸€ä¸ªå…·æœ‰é›¶åˆ°å¤šä¸ªåº•å±‚è¿æ¥çš„è¿æ¥æ± ï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°è¢«å¤šä¸ªgoroutineåŒæ—¶ä½¿ç”¨ã€‚
var db *sql.DB

// å®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–æ•°æ®åº“çš„å‡½æ•°
func initDB() (err error) {

	// DSN:Data Source Name
	dsn := "user:password@tcp(127.0.0.1:3306)/sql_test?charset=utf8mb4&parseTime=True"
  
  //å¦‚æœé…ç½®äº†parseTime=trueï¼ŒMySQLä¸­çš„DATEã€DATETIMEç­‰æ—¶é—´ç±»å‹å­—æ®µå°†è‡ªåŠ¨è½¬æ¢ä¸ºgolangä¸­çš„time.Timeç±»å‹ã€‚ ç±»ä¼¼çš„0000-00-00 00:00:00 ï¼Œä¼šè¢«è½¬ä¸ºtime.Timeçš„é›¶å€¼ã€‚
  
  //locè®¾ç½®ï¼Œé»˜è®¤å€¼ UTCï¼Œè¡¨ç¤ºè§£æä¸ºUTCæ—¶é—´ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºLocalï¼Œè¡¨ç¤ºä½¿ç”¨å½“åœ°æ—¶é—´ï¼Œè¿™ä¸ªè®¾ç½®åªè¡¨ç¤ºè§£æä¸ºtime.Timeç±»å‹æ—¶ï¼Œä½¿ç”¨çš„é…ç½®ã€‚å¹¶ä¸æ”¹å˜MySQLçš„time zoneæ—¶åŒºä¿¡æ¯time_zone settingï¼Œå¦åˆ™ï¼Œå¦‚æœæ²¡æœ‰é…ç½®æˆ–é…ç½®äº†parseTime=false, åªä¼šè½¬ä¸º []byte / string ã€‚
  
	// ä¸ä¼šæ ¡éªŒè´¦å·å¯†ç æ˜¯å¦æ­£ç¡®
	// æ³¨æ„ï¼ï¼ï¼è¿™é‡Œä¸è¦ä½¿ç”¨:=ï¼Œæˆ‘ä»¬æ˜¯ç»™å…¨å±€å˜é‡èµ‹å€¼ï¼Œç„¶ååœ¨mainå‡½æ•°ä¸­ä½¿ç”¨å…¨å±€å˜é‡db
	db, err = sql.Open("mysql", dsn)
	if err != nil {
		return err
	}
	
	// å°è¯•ä¸æ•°æ®åº“å»ºç«‹è¿æ¥ï¼ˆæ ¡éªŒdsnæ˜¯å¦æ­£ç¡®ï¼‰
	err = db.Ping()
	if err != nil {
		return err
	}
	
	//æœ€å¤§è¿æ¥æ—¶é•¿
	db.SetConnMaxLifetime(time.Minute * 3)
	//æœ€å¤§è¿æ¥æ•°
	db.SetMaxOpenConns(10)
	
	//SetMaxIdleConnsè®¾ç½®è¿æ¥æ± ä¸­çš„æœ€å¤§é—²ç½®è¿æ¥æ•°ã€‚ å¦‚æœnå¤§äºæœ€å¤§å¼€å¯è¿æ¥æ•°ï¼Œåˆ™æ–°çš„æœ€å¤§é—²ç½®è¿æ¥æ•°ä¼šå‡å°åˆ°åŒ¹é…æœ€å¤§å¼€å¯è¿æ¥æ•°çš„é™åˆ¶ã€‚ å¦‚æœn<=0ï¼Œä¸ä¼šä¿ç•™é—²ç½®è¿æ¥
	db.SetMaxIdleConns(10)
	
	return nil
}

func main() {
	err := initDB() // è°ƒç”¨åˆå§‹åŒ–æ•°æ®åº“çš„å‡½æ•°
	if err != nil {
		fmt.Printf("init db failed,err:%v\n", err)
		return
	}
  db.close()//é‡Šæ”¾æ•°æ®åº“è¿æ¥æ± èµ„æº
}
```



### 6.stringsåŒ…æ˜¯æ“ä½œå­—ç¬¦ä¸²çš„ï¼Œæ¯”å¦‚æˆªå–ï¼Œå¯»æ‰¾ç­‰

å…·ä½“ç”¨æ³•çœ‹æ‰‹å†Œ



### 7.strconvæ˜¯å­—ç¬¦ä¸²ä¸å…¶ä»–ç±»å‹æ•°æ®ä¹‹é—´çš„è½¬æ¢

å…·ä½“çœ‹æ‰‹å†Œ

